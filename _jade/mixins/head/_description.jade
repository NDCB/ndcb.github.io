include /_jade/base/_functions

//- Adds the metadata for a document description.
    A default description may be provided, but may cause
    certain documents to share the same description.
mixin metaDescription(defaultDescription)
    -
        /**
            Fetches the description of the current document.
        */
        function fetchDocumentDescription(defaultDescription) {
            var metadata = fetchDocumentMetadata();
            if (metadata) {
                if (metadata.description) {
                    return metadata.description;
                } else {
                    console.info(
                        "Info: Using default description for " + getCurrentRelativePath()
                    );
                }
            }
            return defaultDescription;
        }

        var documentDescription = fetchDocumentDescription(defaultDescription);
    if documentDescription
        if documentDescription.length > 155
            -
                console.warn(
                    "Warning: Document description exceeds 155 characters "
                    + "(current length: " + documentDescription.length + ")" 
                    + " for document at " + getCurrentRelativePath()
                );
        //- Add meta tags
        meta(
            property='description' 
            content!=documentDescription
        )
        meta(
            property='og:description' 
            content!=documentDescription
        )
        meta(
            name='twitter:description' 
            content!=documentDescription
        )
    else
        -
            console.error(
                    "Error: Could not locate the document description for " 
                    + getCurrentRelativePath()
            );